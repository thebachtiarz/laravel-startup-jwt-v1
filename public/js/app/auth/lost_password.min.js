$(document).on('keyup', '#form-email', function (e) { (event.keyCode === 13) ? (e.preventDefault(), $('#form-submit').click()) : '' });
$(document).on('click', '#form-submit', function () { let email = $('#form-email').val(); if (email) { submitLostPassword(email) } if (!email) { $('#form-email').attr('placeholder', "Email can't be empty") } });
const submitLostPassword = (email) => axios.post(`/api/auth/signin/lost`, { email }).then(response => { lostPasswordResponse(response.data) }).catch(error => { $('#view-lostpassword-msg').html(spanMessage('danger', error)) });
const lostPasswordResponse = async (data) => { await sleep(1000); if (data.status == 'success') { $('#view-lostpassword-msg').html(spanMessage('success', data.message)) } else { let error = ''; data.message.email ? data.message.email.forEach(msg => error += spanMessage('info', msg)) : error += spanMessage('info', data.message), $('#view-lostpassword-msg').html(error) } }
const spanMessage = (color, message) => `<p class="text-bold text-${color}">${message}</p>`;
$(() => { let lostpassword = `<div class="login-box"><div class="login-logo"><a href="/" class="text-white" style="font-size: 40px; opacity: .8;"><b>Laravel</b> Apps</a></div><div class="card shadow-lg p-1 mb-5 bg-white rounded"><div class="card-body login-card-body"><p class="login-box-msg" id="view-lostpassword-msg">You forgot your password? Here you can easily retrieve a new password.</p><div><div class="input-group mb-3"><input type="email" class="form-control" id="form-email" placeholder="Email"><div class="input-group-append"><div class="input-group-text"><span class="fas fa-envelope"></span></div></div></div><div class="row"><div class="col-12"><button type="submit" class="btn btn-primary btn-block btn-flat text-bold" id="form-submit"><i class="fas fa-paper-plane"></i>&ensp;Request new password</button></div></div></div><p class="mt-3 mb-1"><a href="/signin">Login</a></p><p class="mb-0"><a href="/register" class="text-center">Register a new membership</a></p></div></div></div>`; $('#view-lostpassword-form').prepend(lostpassword) });
