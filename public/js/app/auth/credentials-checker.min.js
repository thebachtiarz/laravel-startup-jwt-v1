$(document).on('click', '#app-signout', function () {
    if (credentialKeyTake()) { axios.post(`/api/auth/logout`, {}, { headers: { 'Accept': 'application/json', 'Authorization': `Bearer ${credentialKeyTake()}` } }).then(response => { toastSuccess(response.data.message), credentialKeyRemove(), redirectTo('/signin') }).catch(error => { toastError(error), credentialKeyRemove(), redirectTo('/signin') }) } else { credentialKeyRemove(), redirectTo('/signin') }
});

$(() => {
    // identify session token
    if (credentialKeyTake()) { axios.post(`/api/auth/me`, {}, { headers: { 'Accept': 'application/json', 'Authorization': `Bearer ${credentialKeyTake()}` } }).then(response => { createUserPanel(response.data.response_data[0]) }).catch(error => { toastError(error), credentialKeyRemove(), redirectTo('/signin') }) } else { credentialKeyRemove(), redirectTo('/signin') }
});

const createUserPanel = (data) => {
    let panel = `<div class="user-panel mt-3 pb-3 mb-3 d-flex"><div class="image"><img src="/AdminLTE-3.0.1/dist/img/user2-160x160.jpg" class="img-circle elevation-2" alt="User Image"></div><div class="info"><a href="#" class="d-block">${data.credentials}</a></div></div><div class="user-panel mt-2 pb-2 mb-2" id="sidebarLink"></div>`;
    $('#sidebar-user-panel').html(panel), sidebarLinkCall()
}
